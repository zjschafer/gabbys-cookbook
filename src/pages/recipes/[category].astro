---
import BaseLayout from '../../layouts/BaseLayout.astro';

import RecipeSection from '../../components/RecipeSection.astro';
import HeroSection from '../../components/HeroSection.astro';

// Generate static paths for each category
export async function getStaticPaths() {
 
const allRecipes = Object.values(import.meta.glob('../recipes/*.md', { eager: true }));
const allCategories = [...new Set(allRecipes.map((category: any) => category.frontmatter.categories).flat())];
  
  return allCategories.map((category) => {
    // const filteredRecipes = allRecipes.filter((recipe: any) => recipe.frontmatter.categories.includes(category)); placed in RecipeSection.astro
    return {
      params: { category },
      // props: { recipes: filteredRecipes }, placed in RecipeSection.astro
    };
  });
}

const { category } = Astro.params;

---
<BaseLayout pageTitle={category} pageDescription={`Gluten free ${category} recipes`}>
      <HeroSection title={category} subtitle={`Recipes in the ${category} category`} text={`Explore our collection of ${category} recipes.`}  />
    
    <RecipeSection recipeList="filtered" />
</BaseLayout>