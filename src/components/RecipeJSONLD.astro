---
const canonicalURL = new URL(Astro.url.pathname, Astro.url);
const siteURL = new URL("/", Astro.url);
const structuredData = {
  "@context": "https://schema.org",
  "@type": "Recipe",
  "name": Astro.props.name,
  "image": Astro.props.image,
  "author": {
    "@type": "Person",
    "name": Astro.props.author
  },
  "datePublished": Astro.props.datePublished,
  "description": Astro.props.description,
  "recipeIngredient": Astro.props.ingredients,
  // "recipeInstructions": Astro.props.instructions,
  "recipeInstructions": Astro.props.recipeInstructions.map((instruction, index) => ({
    "@type": "HowToStep",
    "name": `Step ${index + 1}`,
    "text": instruction,
    "url": `${canonicalURL}#step${index + 1}`,
    "position": index + 1
  })),
  "recipeCategory": Astro.props.recipeCategory,
  "recipeCuisine": Astro.props.recipeCuisine,
  "recipeYield": Astro.props.yield,
  "prepTime": Astro.props.prepTime,
  "cookTime": Astro.props.cookTime,
  "totalTime": Astro.props.totalTime,
  "url": canonicalURL,
  "publisher": {
    "@type": "Organization",
    "name": "Gabby's Cookbook",
    "url": siteURL
  }
};
---
<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

